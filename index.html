<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LeetCode 100-Day Challenge Tracker</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: #f8f8f9;
      color: #2d3748;
      padding: 24px;
      transition: background 0.3s, color 0.3s;
    }
    body.dark {
      background: #1a202c;
      color: #e2e8f0;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      transition: background 0.3s;
    }
    body.dark .container {
      background: #2d3748;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .header {
      background: #ffffff;
      color: #2d3748;
      padding: 32px 24px;
      text-align: center;
      border-bottom: 1px solid #e2e8f0;
      border-radius: 12px 12px 0 0;
    }
    body.dark .header {
      background: #2d3748;
      color: #e2e8f0;
      border-bottom: 1px solid #4a5568;
    }
    .header h1 {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 8px;
    }
    .header p {
      font-size: 1rem;
      color: #718096;
    }
    body.dark .header p {
      color: #a0aec0;
    }

    .progress-section {
      padding: 24px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }
    .stat-card {
      background: #edf2f7;
      color: #2d3748;
      padding: 16px;
      border-radius: 8px;
      text-align: center;
      font-weight: 600;
    }
    .stat-card.completed {
      background: #e6fffa;
      color: #1c4532;
    }
    .stat-card.streak {
      background: #fefcbf;
      color: #744210;
    }
    body.dark .stat-card {
      background: #4a5568;
      color: #e2e8f0;
    }
    body.dark .stat-card.completed {
      background: #2c7a7b;
      color: #e6fffa;
    }
    body.dark .stat-card.streak {
      background: #744210;
      color: #fefcbf;
    }

    .stat-number {
      font-size: 2rem;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .stat-label {
      font-size: 0.9rem;
      color: #718096;
    }
    body.dark .stat-label {
      color: #a0aec0;
    }

    .progress-bar-container {
      background: #e2e8f0;
      border-radius: 12px;
      height: 16px;
      margin: 24px 0 8px;
      overflow: hidden;
    }
    body.dark .progress-bar-container {
      background: #4a5568;
    }
    .progress-bar {
      height: 100%;
      background: #3182ce;
      width: 0%;
      border-radius: 12px;
      transition: width 0.5s;
    }
    body.dark .progress-bar {
      background: #63b3ed;
    }
    .progress-text {
      text-align: center;
      font-size: 0.9rem;
      color: #718096;
      margin-top: 8px;
    }
    body.dark .progress-text {
      color: #a0aec0;
    }

    .days-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 16px;
      margin-top: 24px;
    }

    .day-card {
      background: #ffffff;
      border-radius: 8px;
      padding: 20px;
      border: 1px solid #e2e8f0;
      transition: background 0.3s, border 0.3s;
    }
    .day-card.completed {
      border-left: 4px solid #3182ce;
    }
    body.dark .day-card {
      background: #2d3748;
      border: 1px solid #4a5568;
      color: #e2e8f0;
    }
    body.dark .day-card.completed {
      border-left: 4px solid #63b3ed;
    }

    .day-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    .day-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.25rem;
      font-weight: 700;
      color: #2d3748;
    }
    body.dark .day-title {
      color: #e2e8f0;
    }
    .day-progress {
      background: #edf2f7;
      border-radius: 8px;
      padding: 4px 12px;
      font-size: 0.85rem;
      color: #3182ce;
      font-weight: 500;
    }
    .day-progress.completed {
      background: #e6fffa;
      color: #1c4532;
    }
    body.dark .day-progress {
      background: #4a5568;
      color: #63b3ed;
    }
    body.dark .day-progress.completed {
      background: #2c7a7b;
      color: #e6fffa;
    }

    .problems-list {
      margin-top: 8px;
    }
    .problem-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px;
      background: #f7fafc;
      border-radius: 6px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .problem-item.completed {
      background: #e6fffa;
      border-left: 3px solid #3182ce;
    }
    body.dark .problem-item {
      background: #4a5568;
      color: #e2e8f0;
    }
    body.dark .problem-item.completed {
      background: #2c7a7b;
      border-left: 3px solid #63b3ed;
    }
    .problem-info {
      display: flex;
      align-items: center;
      flex: 1;
    }
    .problem-checkbox {
      margin-right: 12px;
      width: 16px;
      height: 16px;
      cursor: pointer;
    }
    .problem-name {
      font-weight: 500;
      color: #2d3748;
      margin-right: 8px;
    }
    body.dark .problem-name {
      color: #e2e8f0;
    }

    .difficulty {
      padding: 2px 8px;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
    }
    .difficulty.easy {
      background: #e6fffa;
      color: #1c4532;
    }
    .difficulty.medium {
      background: #fefcbf;
      color: #744210;
    }
    .difficulty.hard {
      background: #fed7d7;
      color: #c53030;
    }
    body.dark .difficulty.easy {
      background: #2c7a7b;
      color: #e6fffa;
    }
    body.dark .difficulty.medium {
      background: #744210;
      color: #fefcbf;
    }
    body.dark .difficulty.hard {
      background: #c53030;
      color: #fed7d7;
    }

    .problem-link {
      color: #3182ce;
      text-decoration: none;
      font-size: 0.85rem;
      transition: color 0.2s;
    }
    .problem-link:hover {
      color: #2b6cb0;
    }
    body.dark .problem-link {
      color: #63b3ed;
    }
    body.dark .problem-link:hover {
      color: #90cdf4;
    }

    .notes-textarea {
      width: 100%;
      margin-top: 8px;
      resize: vertical;
      min-height: 32px;
      padding: 8px;
      font-size: 0.9rem;
      border-radius: 6px;
      border: 1px solid #e2e8f0;
      background: #f7fafc;
      color: #2d3748;
      transition: border 0.2s, background 0.2s;
    }
    .notes-textarea:focus {
      border: 1px solid #3182ce;
      outline: none;
      background: #edf2f7;
    }
    body.dark .notes-textarea {
      background: #4a5568;
      color: #e2e8f0;
      border: 1px solid #718096;
    }
    body.dark .notes-textarea:focus {
      border: 1px solid #63b3ed;
      background: #2d3748;
    }

    .controls {
      position: fixed;
      bottom: 24px;
      right: 24px;
      display: flex;
      gap: 12px;
      z-index: 100;
    }
    .control-btn {
      background: #3182ce;
      color: #ffffff;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 0.9rem;
      transition: background 0.2s;
    }
    .control-btn:hover {
      background: #2b6cb0;
    }
    .reset-btn {
      background: #e53e3e;
    }
    .reset-btn:hover {
      background: #c53030;
    }
    #darkModeToggle {
      background: #4a5568;
    }
    #darkModeToggle:hover {
      background: #718096;
    }

    @media (max-width: 768px) {
      .container {
        margin: 8px;
        border-radius: 8px;
      }
      .header {
        padding: 20px 16px;
      }
      .header h1 {
        font-size: 2rem;
      }
      .days-grid {
        grid-template-columns: 1fr;
      }
      .controls {
        bottom: 16px;
        right: 16px;
        flex-direction: column;
        gap: 8px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>LeetCode 100-Day Challenge</h1>
      <p>Master coding interviews with daily practice</p>
    </div>

    <div class="progress-section">
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-number" id="totalProblems">0</div>
          <div class="stat-label">Total Problems</div>
        </div>
        <div class="stat-card completed">
          <div class="stat-number" id="completedProblems">0</div>
          <div class="stat-label">Completed</div>
        </div>
        <div class="stat-card streak">
          <div class="stat-number" id="currentStreak">0</div>
          <div class="stat-label">Day Streak</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="daysRemaining">20</div>
          <div class="stat-label">Days Remaining</div>
        </div>
      </div>

      <div class="progress-bar-container">
        <div class="progress-bar" id="progressBar"></div>
      </div>
      <div class="progress-text" id="progressText">0% Complete</div>

      <div class="days-grid" id="daysContainer">
        <!-- Days will be populated by JavaScript -->
      </div>
    </div>
  </div>

  <div class="controls">
    <button class="control-btn" onclick="exportProgress()">Export Progress</button>
    <button class="control-btn reset-btn" onclick="resetProgress()">Reset All</button>
    <button class="control-btn" id="darkModeToggle" type="button">Dark Mode</button>
  </div>

  <script>
    const problems = {
      1: [
        {name: "Two Sum", difficulty: "Easy", url: "https://leetcode.com/problems/two-sum"},
        {name: "Merge Two Sorted Lists", difficulty: "Easy", url: "https://leetcode.com/problems/merge-two-sorted-lists"},
        {name: "Valid Parentheses", difficulty: "Easy", url: "https://leetcode.com/problems/valid-parentheses"},
        {name: "Add Two Numbers", difficulty: "Medium", url: "https://leetcode.com/problems/add-two-numbers"},
        {name: "Longest Substring Without Repeating Characters", difficulty: "Medium", url: "https://leetcode.com/problems/longest-substring-without-repeating-characters"}
      ],
      2: [
        {name: "Maximum Subarray", difficulty: "Easy", url: "https://leetcode.com/problems/maximum-subarray"},
        {name: "LRU Cache", difficulty: "Medium", url: "https://leetcode.com/problems/lru-cache"},
        {name: "Longest Palindromic Substring", difficulty: "Medium", url: "https://leetcode.com/problems/longest-palindromic-substring"},
        {name: "3Sum", difficulty: "Medium", url: "https://leetcode.com/problems/3sum"},
        {name: "Trapping Rain Water", difficulty: "Hard", url: "https://leetcode.com/problems/trapping-rain-water"}
      ],
      3: [
        {name: "Median of Two Sorted Arrays", difficulty: "Hard", url: "https://leetcode.com/problems/median-of-two-sorted-arrays"},
        {name: "Number of Islands", difficulty: "Medium", url: "https://leetcode.com/problems/number-of-islands"},
        {name: "Product of Array Except Self", difficulty: "Medium", url: "https://leetcode.com/problems/product-of-array-except-self"},
        {name: "Merge Intervals", difficulty: "Medium", url: "https://leetcode.com/problems/merge-intervals"},
        {name: "Merge k Sorted Lists", difficulty: "Hard", url: "https://leetcode.com/problems/merge-k-sorted-lists"}
      ],
      4: [
        {name: "Reverse Linked List", difficulty: "Easy", url: "https://leetcode.com/problems/reverse-linked-list"},
        {name: "Reorder Data in Log Files", difficulty: "Easy", url: "https://leetcode.com/problems/reorder-data-in-log-files"},
        {name: "Happy Number", difficulty: "Easy", url: "https://leetcode.com/problems/happy-number"},
        {name: "Minimum Window Substring", difficulty: "Hard", url: "https://leetcode.com/problems/minimum-window-substring"},
        {name: "Integer to English Words", difficulty: "Hard", url: "https://leetcode.com/problems/integer-to-english-words"}
      ],
      5: [
        {name: "Remove Invalid Parentheses", difficulty: "Hard", url: "https://leetcode.com/problems/remove-invalid-parentheses"},
        {name: "Serialize and Deserialize Binary Tree", difficulty: "Hard", url: "https://leetcode.com/problems/serialize-and-deserialize-binary-tree"},
        {name: "Generate Parentheses", difficulty: "Medium", url: "https://leetcode.com/problems/generate-parentheses"},
        {name: "Search in Rotated Sorted Array", difficulty: "Medium", url: "https://leetcode.com/problems/search-in-rotated-sorted-array"},
        {name: "Copy List with Random Pointer", difficulty: "Medium", url: "https://leetcode.com/problems/copy-list-with-random-pointer"}
      ],
      6: [
        {name: "Meeting Rooms II", difficulty: "Medium", url: "https://leetcode.com/problems/meeting-rooms-ii"},
        {name: "Subarray Sum Equals K", difficulty: "Medium", url: "https://leetcode.com/problems/subarray-sum-equals-k"},
        {name: "Text Justification", difficulty: "Hard", url: "https://leetcode.com/problems/text-justification"},
        {name: "Best Time to Buy and Sell Stock", difficulty: "Easy", url: "https://leetcode.com/problems/best-time-to-buy-and-sell-stock"},
        {name: "Decode String", difficulty: "Medium", url: "https://leetcode.com/problems/decode-string"}
      ],
      7: [
        {name: "Alien Dictionary", difficulty: "Hard", url: "https://leetcode.com/problems/alien-dictionary"},
        {name: "Palindrome Pairs", difficulty: "Hard", url: "https://leetcode.com/problems/palindrome-pairs"},
        {name: "Group Anagrams", difficulty: "Medium", url: "https://leetcode.com/problems/group-anagrams"},
        {name: "Spiral Matrix", difficulty: "Medium", url: "https://leetcode.com/problems/spiral-matrix"},
        {name: "Container With Most Water", difficulty: "Medium", url: "https://leetcode.com/problems/container-with-most-water"}
      ],
      8: [
        {name: "Find Duplicate File in System", difficulty: "Medium", url: "https://leetcode.com/problems/find-duplicate-file-in-system"},
        {name: "K Closest Points to Origin", difficulty: "Medium", url: "https://leetcode.com/problems/k-closest-points-to-origin"},
        {name: "Reconstruct Itinerary", difficulty: "Medium", url: "https://leetcode.com/problems/reconstruct-itinerary"},
        {name: "Merge Sorted Array", difficulty: "Easy", url: "https://leetcode.com/problems/merge-sorted-array"},
        {name: "Next Permutation", difficulty: "Medium", url: "https://leetcode.com/problems/next-permutation"}
      ],
      9: [
        {name: "First Missing Positive", difficulty: "Hard", url: "https://leetcode.com/problems/first-missing-positive"},
        {name: "Insert Delete GetRandom O(1)", difficulty: "Medium", url: "https://leetcode.com/problems/insert-delete-getrandom-o1"},
        {name: "Letter Combinations of a Phone Number", difficulty: "Medium", url: "https://leetcode.com/problems/letter-combinations-of-a-phone-number"},
        {name: "Verifying an Alien Dictionary", difficulty: "Easy", url: "https://leetcode.com/problems/verifying-an-alien-dictionary"},
        {name: "Reverse Integer", difficulty: "Easy", url: "https://leetcode.com/problems/reverse-integer"}
      ],
      10: [
        {name: "Word Search", difficulty: "Medium", url: "https://leetcode.com/problems/word-search"},
        {name: "Coin Change", difficulty: "Medium", url: "https://leetcode.com/problems/coin-change"},
        {name: "Maximal Rectangle", difficulty: "Hard", url: "https://leetcode.com/problems/maximal-rectangle"},
        {name: "Regular Expression Matching", difficulty: "Hard", url: "https://leetcode.com/problems/regular-expression-matching"},
        {name: "Minimum Time Difference", difficulty: "Medium", url: "https://leetcode.com/problems/minimum-time-difference"}
      ],
      11: [
        {name: "Permutations", difficulty: "Medium", url: "https://leetcode.com/problems/permutations"},
        {name: "Time Based Key-Value Store", difficulty: "Medium", url: "https://leetcode.com/problems/time-based-key-value-store"},
        {name: "Decode Ways", difficulty: "Medium", url: "https://leetcode.com/problems/decode-ways"},
        {name: "Maximal Square", difficulty: "Medium", url: "https://leetcode.com/problems/maximal-square"},
        {name: "Word Ladder", difficulty: "Medium", url: "https://leetcode.com/problems/word-ladder"}
      ],
      12: [
        {name: "Minimum Cost Tree From Leaf Values", difficulty: "Medium", url: "https://leetcode.com/problems/minimum-cost-tree-from-leaf-values"},
        {name: "Asteroid Collision", difficulty: "Medium", url: "https://leetcode.com/problems/asteroid-collision"},
        {name: "Burst Balloons", difficulty: "Hard", url: "https://leetcode.com/problems/burst-balloons"},
        {name: "UTF-8 Validation", difficulty: "Medium", url: "https://leetcode.com/problems/utf-8-validation"},
        {name: "Before and After Puzzle", difficulty: "Medium", url: "https://leetcode.com/problems/before-and-after-puzzle"}
      ],
      13: [
        {name: "Cherry Pickup", difficulty: "Hard", url: "https://leetcode.com/problems/cherry-pickup"},
        {name: "Fraction to Recurring Decimal", difficulty: "Medium", url: "https://leetcode.com/problems/fraction-to-recurring-decimal"},
        {name: "Design Search Autocomplete System", difficulty: "Hard", url: "https://leetcode.com/problems/design-search-autocomplete-system"},
        {name: "The Skyline Problem", difficulty: "Hard", url: "https://leetcode.com/problems/the-skyline-problem"},
        {name: "Binary Tree Maximum Path Sum", difficulty: "Hard", url: "https://leetcode.com/problems/binary-tree-maximum-path-sum"}
      ],
      14: [
        {name: "Longest Valid Parentheses", difficulty: "Hard", url: "https://leetcode.com/problems/longest-valid-parentheses"},
        {name: "Valid Palindrome", difficulty: "Easy", url: "https://leetcode.com/problems/valid-palindrome"},
        {name: "Word Break", difficulty: "Medium", url: "https://leetcode.com/problems/word-break"},
        {name: "Roman to Integer", difficulty: "Easy", url: "https://leetcode.com/problems/roman-to-integer"},
        {name: "Fizz Buzz", difficulty: "Easy", url: "https://leetcode.com/problems/fizz-buzz"}
      ],
      15: [
        {name: "Friend Circles", difficulty: "Medium", url: "https://leetcode.com/problems/friend-circles"},
        {name: "Edit Distance", difficulty: "Hard", url: "https://leetcode.com/problems/edit-distance"},
        {name: "Search a 2D Matrix II", difficulty: "Medium", url: "https://leetcode.com/problems/search-a-2d-matrix-ii"},
        {name: "Kth Largest Element in an Array", difficulty: "Medium", url: "https://leetcode.com/problems/kth-largest-element-in-an-array"},
        {name: "Find Median from Data Stream", difficulty: "Hard", url: "https://leetcode.com/problems/find-median-from-data-stream"}
      ],
      16: [
        {name: "Flatten Nested List Iterator", difficulty: "Medium", url: "https://leetcode.com/problems/flatten-nested-list-iterator"},
        {name: "Task Scheduler", difficulty: "Medium", url: "https://leetcode.com/problems/task-scheduler"},
        {name: "Employee Free Time", difficulty: "Hard", url: "https://leetcode.com/problems/employee-free-time"},
        {name: "Binary Tree Right Side View", difficulty: "Medium", url: "https://leetcode.com/problems/binary-tree-right-side-view"},
        {name: "Jump Game II", difficulty: "Hard", url: "https://leetcode.com/problems/jump-game-ii"}
      ],
      17: [
        {name: "Longest String Chain", difficulty: "Medium", url: "https://leetcode.com/problems/longest-string-chain"},
        {name: "LFU Cache", difficulty: "Hard", url: "https://leetcode.com/problems/lfu-cache"},
        {name: "Word Search II", difficulty: "Hard", url: "https://leetcode.com/problems/word-search-ii"},
        {name: "Split Array Largest Sum", difficulty: "Hard", url: "https://leetcode.com/problems/split-array-largest-sum"},
        {name: "Basic Calculator II", difficulty: "Hard", url: "https://leetcode.com/problems/basic-calculator-ii"}
      ],
      18: [
        {name: "Nested List Weight Sum II", difficulty: "Medium", url: "https://leetcode.com/problems/nested-list-weight-sum-ii"},
        {name: "Design Hit Counter", difficulty: "Medium", url: "https://leetcode.com/problems/design-hit-counter"},
        {name: "Reaching Points", difficulty: "Hard", url: "https://leetcode.com/problems/reaching-points"},
        {name: "Flatten a Multilevel Doubly Linked List", difficulty: "Medium", url: "https://leetcode.com/problems/flatten-a-multilevel-doubly-linked-list"},
        {name: "Read N Characters Given Read4 II - Call multiple times", difficulty: "Hard", url: "https://leetcode.com/problems/read-n-characters-given-read4-ii--call-multiple-times"}
      ],
      19: [
        {name: "Swap Nodes in Pairs", difficulty: "Medium", url: "https://leetcode.com/problems/swap-nodes-in-pairs"},
        {name: "Min Stack", difficulty: "Easy", url: "https://leetcode.com/problems/min-stack"},
        {name: "Rotate Image", difficulty: "Medium", url: "https://leetcode.com/problems/rotate-image"},
        {name: "Reverse String", difficulty: "Easy", url: "https://leetcode.com/problems/reverse-string"},
        {name: "Integer to Roman", difficulty: "Medium", url: "https://leetcode.com/problems/integer-to-roman"}
      ],
      20: [
        {name: "Palindrome Number", difficulty: "Easy", url: "https://leetcode.com/problems/palindrome-number"},
        {name: "Pour Water", difficulty: "Medium", url: "https://leetcode.com/problems/pour-water"}
      ]
    };

    let progress = {};
    let completedDays = [];
    let notes = {};

    // Utility function to escape JavaScript string literals
    function escapeJsString(str) {
      return str.replace(/(['"\\])/g, '\\$1').replace(/\n/g, '\\n').replace(/\r/g, '\\r').replace(/\t/g, '\\t');
    }

    function loadProgress() {
      try {
        const saved = JSON.parse(localStorage.getItem('leetcodeProgress') || '{}');
        progress = saved.progress || {};
        completedDays = saved.completedDays || [];
        notes = saved.notes || {};
      } catch {
        progress = {};
        completedDays = [];
        notes = {};
      }
    }

    function saveProgress() {
      try {
        localStorage.setItem('leetcodeProgress', JSON.stringify({ progress, completedDays, notes }));
      } catch {}
    }

    function initializeTracker() {
      loadProgress();
      renderDays();
      updateStats();
      setInitialTheme();
    }

    function setInitialTheme() {
      const darkPref = localStorage.getItem('leetcodeDarkMode');
      if (darkPref === 'true') {
        document.body.classList.add('dark');
        document.getElementById('darkModeToggle').textContent = 'Light Mode';
      } else {
        document.body.classList.remove('dark');
        document.getElementById('darkModeToggle').textContent = 'Dark Mode';
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
      initializeTracker();
      document.getElementById('darkModeToggle').addEventListener('click', function() {
        document.body.classList.toggle('dark');
        const isDark = document.body.classList.contains('dark');
        this.textContent = isDark ? 'Light Mode' : 'Dark Mode';
        try {
          localStorage.setItem('leetcodeDarkMode', isDark ? "true" : "false");
        } catch {}
      });
    });

    function renderDays() {
      const container = document.getElementById('daysContainer');
      container.innerHTML = '';

      Object.keys(problems).forEach(day => {
        const dayNum = parseInt(day);
        const dayProblems = problems[day];
        const completedCount = dayProblems.filter(p => progress[`${day}-${p.name}`]).length;
        const isCompleted = completedCount === dayProblems.length;

        const dayCard = document.createElement('div');
        dayCard.className = `day-card${isCompleted ? ' completed' : ''}`;

        let problemsHtml = dayProblems.map(problem => {
          const key = `${day}-${problem.name}`;
          const isCompleted = progress[key];
          const noteVal = notes[key] || "";
          const escapedName = escapeJsString(problem.name);
          return `
            <div class="problem-item${isCompleted ? ' completed' : ''}">
              <div class="problem-info">
                <input type="checkbox" class="problem-checkbox"
                  ${isCompleted ? 'checked' : ''}
                  onchange="toggleProblem('${day}', '${escapedName}')">
                <span class="problem-name">${problem.name}</span>
                <span class="difficulty ${problem.difficulty.toLowerCase()}">${problem.difficulty}</span>
              </div>
              <a href="${problem.url}" target="_blank" class="problem-link">Solve</a>
            </div>
            <textarea class="notes-textarea" placeholder="Add notes..." onchange="saveNote('${day}', '${escapedName}', this.value)">${noteVal}</textarea>
          `;
        }).join('');

        dayCard.innerHTML = `
          <div class="day-header">
            <div class="day-title">Day ${day}</div>
            <div class="day-progress${isCompleted ? ' completed' : ''}">
              ${completedCount}/${dayProblems.length}
            </div>
          </div>
          <div class="problems-list">
            ${problemsHtml}
          </div>
        `;
        container.appendChild(dayCard);
      });
    }

    function toggleProblem(day, problemName) {
      const key = `${day}-${problemName}`;
      progress[key] = !progress[key];

      const dayProblems = problems[day];
      const completedCount = dayProblems.filter(p => progress[`${day}-${p.name}`]).length;
      const wasCompleted = completedDays.includes(parseInt(day));
      const isNowCompleted = completedCount === dayProblems.length;

      if (isNowCompleted && !wasCompleted) {
        completedDays.push(parseInt(day));
      } else if (!isNowCompleted && wasCompleted) {
        completedDays = completedDays.filter(d => d !== parseInt(day));
      }

      saveProgress();
      renderDays();
      updateStats();
    }

    function saveNote(day, problemName, val) {
      notes[`${day}-${problemName}`] = val.trim();
      saveProgress();
    }

    function updateStats() {
      let totalProblems = 0;
      let completedProblems = 0;

      Object.keys(problems).forEach(day => {
        const dayProblems = problems[day];
        totalProblems += dayProblems.length;
        completedProblems += dayProblems.filter(p => progress[`${day}-${p.name}`]).length;
      });

      const progressPercentage = totalProblems > 0 ? (completedProblems / totalProblems * 100) : 0;
      const currentStreak = calculateStreak();
      const daysRemaining = 20 - completedDays.length;

      document.getElementById('totalProblems').textContent = totalProblems;
      document.getElementById('completedProblems').textContent = completedProblems;
      document.getElementById('currentStreak').textContent = currentStreak;
      document.getElementById('daysRemaining').textContent = Math.max(0, daysRemaining);

      const progressBar = document.getElementById('progressBar');
      const progressText = document.getElementById('progressText');

      progressBar.style.width = progressPercentage + '%';
      progressText.textContent = Math.round(progressPercentage) + '% Complete';
    }

    function calculateStreak() {
      if (completedDays.length === 0) return 0;
      const sortedDays = [...completedDays].sort((a, b) => a - b);
      let streak = 1,
        maxStreak = 1;
      for (let i = 1; i < sortedDays.length; i++) {
        if (sortedDays[i] === sortedDays[i - 1] + 1) {
          streak++;
          maxStreak = Math.max(maxStreak, streak);
        } else {
          streak = 1;
        }
      }
      return maxStreak;
    }

    function exportProgress() {
      let totalProblems = 0;
      let completedProblems = 0;

      Object.keys(problems).forEach(day => {
        const dayProblems = problems[day];
        totalProblems += dayProblems.length;
        completedProblems += dayProblems.filter(p => progress[`${day}-${p.name}`]).length;
      });

      const report = `
LeetCode 100-Day Challenge Progress Report
==========================================

Overall Statistics:
• Total Problems: ${totalProblems}
• Completed Problems: ${completedProblems}
• Progress: ${Math.round(completedProblems / totalProblems * 100)}%
• Days Completed: ${completedDays.length}/20
• Current Streak: ${calculateStreak()} days

Day-by-Day Breakdown:
${Object.keys(problems)
  .map(day => {
    const dayProblems = problems[day];
    const completed = dayProblems.filter(p => progress[`${day}-${p.name}`]).length;
    const status = completed === dayProblems.length ? '✅' : '⏳';
    return `Day ${day}: ${status} ${completed}/${dayProblems.length} problems completed`;
  })
  .join('\n')}

Generated on: ${new Date().toLocaleDateString()}
      `;
      const blob = new Blob([report], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `leetcode-progress-${new Date().toISOString().split('T')[0]}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function resetProgress() {
      if (confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
        progress = {};
        completedDays = [];
        notes = {};
        saveProgress();
        renderDays();
        updateStats();
      }
    }

    window.toggleProblem = toggleProblem;
    window.saveNote = saveNote;
  </script>
</body>
</html>